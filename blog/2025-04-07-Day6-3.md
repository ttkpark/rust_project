---
title: "Day 6 - Serial splitκ³Ό _rxμ μλ―Έ: μμ›μ„ μ•μ „ν•κ² λ‚λ„λ” Rust λ°©μ‹"
date: 2025-04-07
categories: [rust_project]
tags: [Rust, Embedded, STM32, UART, Ownership, rust_project]
description: "Serial ν†µμ‹  μ„¤μ • ν›„ `.split()`μ„ ν†µν•΄ μ†΅μμ‹  κ°μ²΄λ΅ λ‚λ„λ” μ΄μ μ™€ `_rx`μ²λΌ λ³€μλ…μ„ λ…μ‹μ μΌλ΅ λ¬΄μ‹ν•λ” Rust μ¤νƒ€μΌμ— λ€ν•΄ μ„¤λ…ν•©λ‹λ‹¤."
---

μ¤λ UART ν†µμ‹ μ„ κµ¬μ„±ν•λ©΄μ„ `Serial::new()` λ΅ λ§λ“  μ‹λ¦¬μ–Ό κ°μ²΄λ¥Ό `.split()`μΌλ΅ λ‚λ μ„ `tx`λ§ μ‚¬μ©ν•λ” κµ¬μ΅°λ¥Ό κµ¬ν„ν–λ‹¤.  
μ—¬κΈ°μ„ ν¥λ―Έλ΅μ΄ ν¬μΈνΈλ” λ‘ κ°€μ§€μ€λ‹¤:

1. μ™ κµ³μ΄ `.split()`μ„ ν•΄μ•Ό ν• κΉ?
2. κ·Έλ¦¬κ³  `let (_, _rx)` κ°€ μ•„λ‹ `let (mut tx, _rx)`μ²λΌ μ–Έλ”λ°”(`_`)λ΅ μ‹μ‘ν•λ” λ³€μ μ΄λ¦„μ€ μ–΄λ–¤ μλ―Έλ¥Ό κ°€μ§κΉ?

---

## 1. Serial κ°μ²΄λ” ν•λ‚μ§€λ§, λ‚΄λ¶€λ” λ‘ κ°μ μμ›

`Serial::new(...)` μΌλ΅ λ§λ“  κ°μ²΄λ” `Serial<USART1, (TxPin, RxPin)>` νƒ€μ…μ΄λ‹¤.  
μ΄λ” **μ†΅μ‹ (Tx)κ³Ό μμ‹ (Rx)** μ΄ κ²°ν•©λ μƒνƒμ΄λ©°, μ΄ μμ²΄λ” ν•λ‚μ μ†μ κ¶ κµ¬μ΅°λ΅ λμ–΄ μλ‹¤.

ν•μ§€λ§ μ°λ¦¬λ” λ³΄ν†µ:

- **μ†΅μ‹ λ§ μ‚¬μ©**ν•κ±°λ‚
- **μμ‹ λ§ μΈν„°λ½νΈμ— λ“±λ΅**ν•κ±°λ‚
- **λ‘μ„ κ°λ³„μ μΌλ΅ λ‹¤λ£¨κ³  μ‹¶μ„** μ μλ‹¤.

μ΄λ• ν•„μ”ν• κ²ƒμ΄ `.split()`μ΄λ‹¤.

---

## 2. `.split()`μ λ™μ‘ μ›λ¦¬

```rust
let (mut tx, _rx) = serial.split();
```

μ΄ μ½”λ“λ” λ‚΄λ¶€μ μΌλ΅ `serial` κ°μ²΄λ¥Ό **λ‘ κ°μ λ³„λ„ κµ¬μ΅°μ²΄λ΅ λ¶„λ¦¬**ν•©λ‹λ‹¤:

- `tx: Tx<USART1>`: μ†΅μ‹ κΈ° β†’ `writeln!()` λ“±μΌλ΅ μ¶λ ¥ κ°€λ¥
- `rx: Rx<USART1>`: μμ‹ κΈ° β†’ λ³΄ν†µ μΈν„°λ½νΈμ—μ„ μ½κΈ° μ©λ„λ΅ μ‚¬μ©

> π’΅ `.split()`μ€ Rustμ μ†μ κ¶ λ¨λΈμ„ μ¤€μν•λ©΄μ„, λ‚΄λ¶€ μμ›μ„ λ…λ¦½μ μΌλ΅ λ‹¤λ£° μ μλ„λ΅ ν•΄μ¤λ‹λ‹¤.

---

## 3. μ™ `_rx`μ²λΌ λ³€μλ…μ— `_`λ¥Ό λ¶™μΌκΉ?

Rustλ” λ§¤μ° μ—„κ²©ν• μ–Έμ–΄μ…λ‹λ‹¤. **μ„ μ–Έν•΄λ†“κ³  μ“°μ§€ μ•λ” λ³€μλ” κ²½κ³  λλ” μ¤λ¥λ¥Ό λ°μƒμ‹ν‚µλ‹λ‹¤.**

```rust
let (tx, rx) = serial.split(); // β rxλ¥Ό μ• μ“°λ©΄ μ»΄νμΌλ¬κ°€ κ²½κ³ 
```

μ΄κ±Έ λ°©μ§€ν•κΈ° μ„ν•΄ λ‘ κ°€μ§€ λ°©λ²•μ΄ μμµλ‹λ‹¤:

- μ•„μ λ³€μλ…μ„ `_`λ΅ μ„ μ–Έ β†’ `let (tx, _) = ...`
- λλ” `_rx`μ²λΌ **μ΄λ¦„μ€ μμΌλ‚ μ“°μ§€ μ•μ**μ„ λ…μ‹

```rust
let (mut tx, _rx) = serial.split(); // β… μλ„λ¥Ό λ…ν™•ν ν•¨
```

### μ–Έμ  `_rx`λ¥Ό μ“°λ”κ°€?

- λ‚μ¤‘μ— μ“Έ μλ„ μλ‹¤λ” μλ„λ¥Ό ν¬ν•¨
- λ¬Έμ„ν™”μ™€ κ°€λ…μ„±μ„ λ†’μ΄κΈ° μ„ν•΄ `_` λ‹¨λ…λ³΄λ‹¤ μΆ‹μ
- λ””λ²„κΉ… μ‹μ—λ„ "μ΄κ² Rxμ€κµ¬λ‚"λΌλ” ννΈλ¥Ό μ¤

---

## 4. split ν¨ν„΄μ΄ μ£Όλ” μ¥μ 

Rustμ μ†μ κ¶ μ‹μ¤ν… λ•λ¶„μ—, `tx`μ™€ `rx`λ” κ°κ° **λ³„κ°μ κ°€λ³€ μμ›**μ΄ λ©λ‹λ‹¤.  
μ΄λ” λ‹¤μκ³Ό κ°™μ€ ν¨ν„΄μ—μ„ μ λ¦¬ν•©λ‹λ‹¤:

### β‰οΈ `tx`λ§ μ‚¬μ©ν•λ” κ²½μ°

```rust
writeln!(tx, "log message").unwrap();
```

### π“¥ `rx`λ¥Ό μΈν„°λ½νΈμ— λ“±λ΅ν•λ” κ²½μ°

```rust
#[interrupt]
fn USART1() {
    // rx.read() μ‚¬μ©
}
```

μ΄μ²λΌ ν•„μ”μ— λ”°λΌ μμ›μ„ μΌκ°¤ μ μλ” λ°©μ‹μ€ **λ©€ν‹°νƒμ¤ν‚Ή, μΈν„°λ½νΈ λ€μ‘, μ „μ—­ μμ› μ²λ¦¬** λ“± λ‹¤μ–‘ν• κµ¬μ΅°μ—μ„ ν•„μμ μ…λ‹λ‹¤.

---

## 5. splitμ΄ μ—†μ—λ‹¤λ©΄?

λ§μ•½ `.split()` μ—†μ΄ `serial` κ°μ²΄ μμ²΄λ§ κ°€μ§€κ³  μμ—λ‹¤λ©΄:

- `tx`λ¥Ό μ‚¬μ©ν•  λ•λ§λ‹¤ μ „μ²΄ `serial`μ μ†μ κ¶μ„ λ„κ²¨μ•Ό ν•¨
- μΈν„°λ½νΈ ν•Έλ“¤λ¬μ™€ λ©”μΈ λ£¨ν”„κ°€ λ™μ‹μ— μ ‘κ·Όν•  μ μ—†μ
- λ¶ν•„μ”ν• μ†μ κ¶ μ΄λ™κ³Ό borrow checker μ¶©λμ΄ λ°μƒν•¨

μ¦‰, `.split()`μ€ **μ§λ ¬ ν†µμ‹  μμ›μ„ μ‹¤μ  μ‚¬μ© λ°©μ‹μ— λ§κ² λ…Όλ¦¬μ μΌλ΅ λ¶„ν•΄**ν•λ” μλ‹¨μ…λ‹λ‹¤.

---

## π” μ •λ¦¬

- `.split()`μ€ `Serial` κ°μ²΄λ¥Ό `tx`μ™€ `rx`λ΅ λ‚λ„μ–΄, κ°κ° λ…λ¦½μ μΌλ΅ λ‹¤λ£° μ μκ² ν•λ‹¤.
- `tx`: μ†΅μ‹ κΈ°, `writeln!()` μ‚¬μ© κ°€λ¥ / `rx`: μμ‹ κΈ°, `read()` νΉμ€ μΈν„°λ½νΈμ©
- `_rx`λ” ν•΄λ‹Ή μμ›μ„ μ‚¬μ©ν•μ§€ μ•μ„ κ²ƒμ΄λ€ μλ„λ¥Ό μ»΄νμΌλ¬μ— λ…μ‹
- μ΄ κµ¬μ΅°λ” μ†μ κ¶, λ©€ν‹°νƒμ¤ν‚Ή, μΈν„°λ½νΈ ν•Έλ“¤λ§μ— λ¨λ‘ μ λ¦¬ν•λ‹¤
- μ•μΌλ΅ UARTλΏ μ•„λ‹λΌ SPI, I2C κ°™μ€ κµ¬μ΅°μ—μ„λ„ `.split()` ν¨ν„΄μ€ λ§¤μ° μμ£Ό λ“±μ¥ν•  μμ •

μ¤λμ κΉ¨λ‹¬μμ€ μ΄κ±°λ‹¤:  
**"μμ›μ„ μΌκ°λ” κ²ƒμ€ λ‹¨μ§€ νΈλ¦¬ν•¨μ΄ μ•„λ‹λΌ, μ•μ „ν•¨μ„ μ„ν• κµ¬μ΅°λ‹¤."**